var currentScope,NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state"),errors="production"!==process.env.NODE_ENV?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function die(e,...t){if("production"!==process.env.NODE_ENV){let r=errors[e],n="function"==typeof r?r.apply(null,t):r;throw Error(`[Immer] ${n}`)}throw Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf=Object.getPrototypeOf;function isDraft(e){return!!e&&!!e[DRAFT_STATE]}function isDraftable(e){return!!e&&(isPlainObject(e)||Array.isArray(e)||!!e[DRAFTABLE]||!!e.constructor?.[DRAFTABLE]||isMap(e)||isSet(e))}var objectCtorString=Object.prototype.constructor.toString();function isPlainObject(e){if(!e||"object"!=typeof e)return!1;let t=getPrototypeOf(e);if(null===t)return!0;let r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===objectCtorString}function original(e){return isDraft(e)||die(15,e),e[DRAFT_STATE].base_}function each(e,t){0===getArchtype(e)?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function getArchtype(e){let t=e[DRAFT_STATE];return t?t.type_:Array.isArray(e)?1:isMap(e)?2:isSet(e)?3:0}function has(e,t){return 2===getArchtype(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function get(e,t){return 2===getArchtype(e)?e.get(t):e[t]}function set(e,t,r){let n=getArchtype(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function is(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function isMap(e){return e instanceof Map}function isSet(e){return e instanceof Set}function latest(e){return e.copy_||e.base_}function shallowCopy(e,t){if(isMap(e))return new Map(e);if(isSet(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);let r=isPlainObject(e);if(!0!==t&&("class_only"!==t||r)){let n=getPrototypeOf(e);if(null!==n&&r)return{...e};let a=Object.create(n);return Object.assign(a,e)}{let o=Object.getOwnPropertyDescriptors(e);delete o[DRAFT_STATE];let i=Reflect.ownKeys(o);for(let s=0;s<i.length;s++){let c=i[s],l=o[c];!1===l.writable&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(o[c]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[c]})}return Object.create(getPrototypeOf(e),o)}}function freeze(e,t=!1){return isFrozen(e)||isDraft(e)||!isDraftable(e)||(getArchtype(e)>1&&(e.set=e.add=e.clear=e.delete=dontMutateFrozenCollections),Object.freeze(e),t&&Object.entries(e).forEach(([e,t])=>freeze(t,!0))),e}function dontMutateFrozenCollections(){die(2)}function isFrozen(e){return Object.isFrozen(e)}var plugins={};function getPlugin(e){let t=plugins[e];return t||die(0,e),t}function loadPlugin(e,t){plugins[e]||(plugins[e]=t)}function getCurrentScope(){return currentScope}function createScope(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(e,t){t&&(getPlugin("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function revokeScope(e){leaveScope(e),e.drafts_.forEach(revokeDraft),e.drafts_=null}function leaveScope(e){e===currentScope&&(currentScope=e.parent_)}function enterScope(e){return currentScope=createScope(currentScope,e)}function revokeDraft(e){let t=e[DRAFT_STATE];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function processResult(e,t){t.unfinalizedDrafts_=t.drafts_.length;let r=t.drafts_[0],n=void 0!==e&&e!==r;return n?(r[DRAFT_STATE].modified_&&(revokeScope(t),die(4)),isDraftable(e)&&(e=finalize(t,e),t.parent_||maybeFreeze(t,e)),t.patches_&&getPlugin("Patches").generateReplacementPatches_(r[DRAFT_STATE].base_,e,t.patches_,t.inversePatches_)):e=finalize(t,r,[]),revokeScope(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==NOTHING?e:void 0}function finalize(e,t,r){if(isFrozen(t))return t;let n=t[DRAFT_STATE];if(!n)return each(t,(a,o)=>finalizeProperty(e,n,t,a,o,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return maybeFreeze(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;let a=n.copy_,o=a,i=!1;3===n.type_&&(o=new Set(a),a.clear(),i=!0),each(o,(t,o)=>finalizeProperty(e,n,a,t,o,r,i)),maybeFreeze(e,a,!1),r&&e.patches_&&getPlugin("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function finalizeProperty(e,t,r,n,a,o,i){if("production"!==process.env.NODE_ENV&&a===r&&die(5),isDraft(a)){let s=o&&t&&3!==t.type_&&!has(t.assigned_,n)?o.concat(n):void 0,c=finalize(e,a,s);if(set(r,n,c),!isDraft(c))return;e.canAutoFreeze_=!1}else i&&r.add(a);if(isDraftable(a)&&!isFrozen(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;finalize(e,a),(!t||!t.scope_.parent_)&&"symbol"!=typeof n&&Object.prototype.propertyIsEnumerable.call(r,n)&&maybeFreeze(e,a)}}function maybeFreeze(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&freeze(t,r)}function createProxyProxy(e,t){let r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1},a=n,o=objectTraps;r&&(a=[n],o=arrayTraps);let{revoke:i,proxy:s}=Proxy.revocable(a,o);return n.draft_=s,n.revoke_=i,s}var objectTraps={get(e,t){if(t===DRAFT_STATE)return e;let r=latest(e);if(!has(r,t))return readPropFromProto(e,r,t);let n=r[t];return e.finalized_||!isDraftable(n)?n:n===peek(e.base_,t)?(prepareCopy(e),e.copy_[t]=createProxy(n,e)):n},has:(e,t)=>t in latest(e),ownKeys:e=>Reflect.ownKeys(latest(e)),set(e,t,r){let n=getDescriptorFromProto(latest(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){let a=peek(latest(e),t),o=a?.[DRAFT_STATE];if(o&&o.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(is(r,a)&&(void 0!==r||has(e.base_,t)))return!0;prepareCopy(e),markChanged(e)}return!!(e.copy_[t]===r&&(void 0!==r||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t]))||(e.copy_[t]=r,e.assigned_[t]=!0,!0)},deleteProperty:(e,t)=>(void 0!==peek(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,prepareCopy(e),markChanged(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){let r=latest(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:n.enumerable,value:r[t]}:n},defineProperty(){die(11)},getPrototypeOf:e=>getPrototypeOf(e.base_),setPrototypeOf(){die(12)}},arrayTraps={};function peek(e,t){let r=e[DRAFT_STATE],n=r?latest(r):e;return n[t]}function readPropFromProto(e,t,r){let n=getDescriptorFromProto(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function getDescriptorFromProto(e,t){if(!(t in e))return;let r=getPrototypeOf(e);for(;r;){let n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=getPrototypeOf(r)}}function markChanged(e){!e.modified_&&(e.modified_=!0,e.parent_&&markChanged(e.parent_))}function prepareCopy(e){e.copy_||(e.copy_=shallowCopy(e.base_,e.scope_.immer_.useStrictShallowCopy_))}each(objectTraps,(e,t)=>{arrayTraps[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),arrayTraps.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&die(13),arrayTraps.set.call(this,e,t,void 0)},arrayTraps.set=function(e,t,r){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&die(14),objectTraps.set.call(this,e[0],t,r,e[0])};var Immer2=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,r)=>{if("function"==typeof e&&"function"!=typeof t){let n=t;t=e;let a=this;return function e(r=n,...o){return a.produce(r,e=>t.call(this,e,...o))}}"function"!=typeof t&&die(6),void 0!==r&&"function"!=typeof r&&die(7);let o;if(isDraftable(e)){let i=enterScope(this),s=createProxy(e,void 0),c=!0;try{o=t(s),c=!1}finally{c?revokeScope(i):leaveScope(i)}return usePatchesInScope(i,r),processResult(o,i)}if(e&&"object"==typeof e)die(1,e);else{if(void 0===(o=t(e))&&(o=e),o===NOTHING&&(o=void 0),this.autoFreeze_&&freeze(o,!0),r){let l=[],u=[];getPlugin("Patches").generateReplacementPatches_(e,o,l,u),r(l,u)}return o}},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...r)=>this.produceWithPatches(t,t=>e(t,...r));let r,n,a=this.produce(e,t,(e,t)=>{r=e,n=t});return[a,r,n]},"boolean"==typeof e?.autoFreeze&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof e?.useStrictShallowCopy&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){isDraftable(e)||die(8),isDraft(e)&&(e=current(e));let t=enterScope(this),r=createProxy(e,void 0);return r[DRAFT_STATE].isManual_=!0,leaveScope(t),r}finishDraft(e,t){let r=e&&e[DRAFT_STATE];r&&r.isManual_||die(9);let{scope_:n}=r;return usePatchesInScope(n,t),processResult(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){let n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));let a=getPlugin("Patches").applyPatches_;return isDraft(e)?a(e,t):this.produce(e,e=>a(e,t))}};function createProxy(e,t){let r=isMap(e)?getPlugin("MapSet").proxyMap_(e,t):isSet(e)?getPlugin("MapSet").proxySet_(e,t):createProxyProxy(e,t),n=t?t.scope_:getCurrentScope();return n.drafts_.push(r),r}function current(e){return isDraft(e)||die(10,e),currentImpl(e)}function currentImpl(e){if(!isDraftable(e)||isFrozen(e))return e;let t=e[DRAFT_STATE],r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=shallowCopy(e,t.scope_.immer_.useStrictShallowCopy_)}else r=shallowCopy(e,!0);return each(r,(e,t)=>{set(r,e,currentImpl(t))}),t&&(t.finalized_=!1),r}function enablePatches(){"production"!==process.env.NODE_ENV&&errors.push('Sets cannot have "replace" patches.',function(e){return"Unsupported patch operation: "+e},function(e){return"Cannot apply patch, path doesn't resolve: "+e},"Patching reserved attributes like __proto__, prototype and constructor is not allowed");let e="replace",t="remove";function r(e){if(!isDraftable(e))return e;if(Array.isArray(e))return e.map(r);if(isMap(e))return new Map(Array.from(e.entries()).map(([e,t])=>[e,r(t)]));if(isSet(e))return new Set(Array.from(e).map(r));let t=Object.create(getPrototypeOf(e));for(let n in e)t[n]=r(e[n]);return has(e,DRAFTABLE)&&(t[DRAFTABLE]=e[DRAFTABLE]),t}function n(e){return isDraft(e)?r(e):e}loadPlugin("Patches",{applyPatches_:function n(a,o){return o.forEach(n=>{let{path:o,op:i}=n,s=a;for(let c=0;c<o.length-1;c++){let l=getArchtype(s),u=o[c];"string"!=typeof u&&"number"!=typeof u&&(u=""+u),(0===l||1===l)&&("__proto__"===u||"constructor"===u)&&die(19),"function"==typeof s&&"prototype"===u&&die(19),"object"!=typeof(s=get(s,u))&&die(18,o.join("/"))}let p=getArchtype(s),f=r(n.value),d=o[o.length-1];switch(i){case e:switch(p){case 2:return s.set(d,f);case 3:die(16);default:return s[d]=f}case"add":switch(p){case 1:return"-"===d?s.push(f):s.splice(d,0,f);case 2:return s.set(d,f);case 3:return s.add(f);default:return s[d]=f}case t:switch(p){case 1:return s.splice(d,1);case 2:return s.delete(d);case 3:return s.delete(n.value);default:return delete s[d]}default:die(17,i)}}),a},generatePatches_:function r(a,o,i,s){switch(a.type_){case 0:case 2:return function r(a,o,i,s){let{base_:c,copy_:l}=a;each(a.assigned_,(r,a)=>{let u=get(c,r),p=get(l,r),f=a?has(c,r)?e:"add":t;if(u===p&&f===e)return;let d=o.concat(r);i.push(f===t?{op:f,path:d}:{op:f,path:d,value:p}),s.push("add"===f?{op:t,path:d}:f===t?{op:"add",path:d,value:n(u)}:{op:e,path:d,value:n(u)})})}(a,o,i,s);case 1:return function r(a,o,i,s){let{base_:c,assigned_:l}=a,u=a.copy_;u.length<c.length&&([c,u]=[u,c],[i,s]=[s,i]);for(let p=0;p<c.length;p++)if(l[p]&&u[p]!==c[p]){let f=o.concat([p]);i.push({op:e,path:f,value:n(u[p])}),s.push({op:e,path:f,value:n(c[p])})}for(let d=c.length;d<u.length;d++){let h=o.concat([d]);i.push({op:"add",path:h,value:n(u[d])})}for(let y=u.length-1;c.length<=y;--y){let g=o.concat([y]);s.push({op:t,path:g})}}(a,o,i,s);case 3:return function e(r,n,a,o){let{base_:i,copy_:s}=r,c=0;i.forEach(e=>{if(!s.has(e)){let r=n.concat([c]);a.push({op:t,path:r,value:e}),o.unshift({op:"add",path:r,value:e})}c++}),c=0,s.forEach(e=>{if(!i.has(e)){let r=n.concat([c]);a.push({op:"add",path:r,value:e}),o.unshift({op:t,path:r,value:e})}c++})}(a,o,i,s)}},generateReplacementPatches_:function t(r,n,a,o){a.push({op:e,path:[],value:n===NOTHING?void 0:n}),o.push({op:e,path:[],value:r})}})}function enableMapSet(){class e extends Map{constructor(e,t){super(),this[DRAFT_STATE]={type_:2,parent_:t,scope_:t?t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:e,draft_:this,isManual_:!1,revoked_:!1}}get size(){return latest(this[DRAFT_STATE]).size}has(e){return latest(this[DRAFT_STATE]).has(e)}set(e,r){let n=this[DRAFT_STATE];return a(n),latest(n).has(e)&&latest(n).get(e)===r||(t(n),markChanged(n),n.assigned_.set(e,!0),n.copy_.set(e,r),n.assigned_.set(e,!0)),this}delete(e){if(!this.has(e))return!1;let r=this[DRAFT_STATE];return a(r),t(r),markChanged(r),r.base_.has(e)?r.assigned_.set(e,!1):r.assigned_.delete(e),r.copy_.delete(e),!0}clear(){let e=this[DRAFT_STATE];a(e),latest(e).size&&(t(e),markChanged(e),e.assigned_=new Map,each(e.base_,t=>{e.assigned_.set(t,!1)}),e.copy_.clear())}forEach(e,t){let r=this[DRAFT_STATE];latest(r).forEach((r,n,a)=>{e.call(t,this.get(n),n,this)})}get(e){let r=this[DRAFT_STATE];a(r);let n=latest(r).get(e);if(r.finalized_||!isDraftable(n)||n!==r.base_.get(e))return n;let o=createProxy(n,r);return t(r),r.copy_.set(e,o),o}keys(){return latest(this[DRAFT_STATE]).keys()}values(){let e=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{let t=e.next();if(t.done)return t;let r=this.get(t.value);return{done:!1,value:r}}}}entries(){let e=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{let t=e.next();if(t.done)return t;let r=this.get(t.value);return{done:!1,value:[t.value,r]}}}}[Symbol.iterator](){return this.entries()}}function t(e){e.copy_||(e.assigned_=new Map,e.copy_=new Map(e.base_))}class r extends Set{constructor(e,t){super(),this[DRAFT_STATE]={type_:3,parent_:t,scope_:t?t.scope_:getCurrentScope(),modified_:!1,finalized_:!1,copy_:void 0,base_:e,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return latest(this[DRAFT_STATE]).size}has(e){let t=this[DRAFT_STATE];return(a(t),t.copy_)?!!(t.copy_.has(e)||t.drafts_.has(e)&&t.copy_.has(t.drafts_.get(e))):t.base_.has(e)}add(e){let t=this[DRAFT_STATE];return a(t),this.has(e)||(n(t),markChanged(t),t.copy_.add(e)),this}delete(e){if(!this.has(e))return!1;let t=this[DRAFT_STATE];return a(t),n(t),markChanged(t),t.copy_.delete(e)||!!t.drafts_.has(e)&&t.copy_.delete(t.drafts_.get(e))}clear(){let e=this[DRAFT_STATE];a(e),latest(e).size&&(n(e),markChanged(e),e.copy_.clear())}values(){let e=this[DRAFT_STATE];return a(e),n(e),e.copy_.values()}entries(){let e=this[DRAFT_STATE];return a(e),n(e),e.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(e,t){let r=this.values(),n=r.next();for(;!n.done;)e.call(t,n.value,n.value,this),n=r.next()}}function n(e){e.copy_||(e.copy_=new Set,e.base_.forEach(t=>{if(isDraftable(t)){let r=createProxy(t,e);e.drafts_.set(t,r),e.copy_.add(r)}else e.copy_.add(t)}))}function a(e){e.revoked_&&die(3,JSON.stringify(latest(e)))}loadPlugin("MapSet",{proxyMap_:function t(r,n){return new e(r,n)},proxySet_:function e(t,n){return new r(t,n)}})}var immer=new Immer2,produce=immer.produce,produceWithPatches=immer.produceWithPatches.bind(immer),setAutoFreeze=immer.setAutoFreeze.bind(immer),setUseStrictShallowCopy=immer.setUseStrictShallowCopy.bind(immer),applyPatches=immer.applyPatches.bind(immer),createDraft=immer.createDraft.bind(immer),finishDraft=immer.finishDraft.bind(immer);function castDraft(e){return e}function castImmutable(e){return e}export{Immer2 as Immer,applyPatches,castDraft,castImmutable,createDraft,current,enableMapSet,enablePatches,finishDraft,freeze,DRAFTABLE as immerable,isDraft,isDraftable,NOTHING as nothing,original,produce,produceWithPatches,setAutoFreeze,setUseStrictShallowCopy};