<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bestdori剧情文本转JSON转换器</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.6.0/axios.min.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>文本转JSON转换器</h1>
            <p>将对话文本转换为JSON格式，支持多种角色映射</p>
        </div>

        <div class="main-content">
            <!-- 文件上传区域 -->
            <div class="section">
                <div class="section-title">📁 文件上传</div>
                <div class="file-upload" id="fileUpload">
                    <input type="file" accept=".txt" id="fileInput">
                    <div class="file-upload-label">
                        <div>
                            <div style="font-size: 2rem; margin-bottom: 10px;">📄</div>
                            <div style="font-weight: 600; margin-bottom: 5px;">点击或拖拽上传.txt文件</div>
                            <div style="font-size: 0.9rem; color: #718096;">支持最大16MB的文本文件</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 文本输入区域 -->
            <div class="section">
                <div class="section-title">✏️ 文本输入</div>
                <div class="form-group">
                    <label class="form-label">输入对话文本：</label>
<textarea class="form-input textarea" id="inputText" placeholder='请输入需要转换的对话文本...

支持格式：
角色名：对话内容
角色名："对话内容"
其余部分为旁白内容
最好每个对话之间用一个空行分隔'></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">旁白名称（默认为空白）：</label>
                    <input type="text" class="form-input" id="narratorName" value=" " placeholder="设置旁白的名称">
                </div>
            </div>

            <!-- 操作按钮 -->
            <div class="section">
                <div class="section-title">⚡ 操作</div>
                <div class="btn-group">
                    <button class="btn btn-primary" id="convertBtn">
                        <span id="convertIcon">🔄</span>
                        <span id="convertText">开始转换</span>
                    </button>
                    <button class="btn btn-secondary" id="previewBtn">
                        👁️ 预览结果
                    </button>
                    <button class="btn btn-secondary" id="configBtn">
                        ⚙️ 配置管理
                    </button>
                </div>

                <!-- 进度条 -->
                <div class="progress-container" id="progressContainer" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div id="statusMessage" class="status-message status-info">准备转换...</div>
                </div>
            </div>

            <!-- 结果显示区域 -->
            <div class="section" id="resultSection" style="display: none;">
                <div class="result-header">
                    <div class="section-title">📋 转换结果</div>
                    <button class="btn btn-success" id="downloadBtn">
                        💾 下载JSON
                    </button>
                </div>
                <div class="result-content" id="resultContent"></div>
            </div>
        </div>
    </div>

    <!-- 预览模态框 -->
    <div class="modal" id="previewModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">转换预览</div>
                <button class="modal-close" onclick="closeModal('previewModal')">×</button>
            </div>
            <div class="modal-body">
                <div class="result-content" id="previewContent"></div>
            </div>
        </div>
    </div>

    <!-- 配置管理模态框 -->
    <div class="modal" id="configModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">角色映射配置</div>
                <button class="modal-close" onclick="closeModal('configModal')">×</button>
            </div>
            <div class="modal-body">
                <div style="margin-bottom: 20px;">
                    <p style="color: #718096; margin-bottom: 10px;">配置角色名称与ID的映射关系，多个ID用逗号分隔</p>
                    <button class="btn btn-secondary" id="addConfigBtn">➕ 添加角色</button>
                </div>
                <div id="configList"></div>
                <div style="margin-top: 20px; text-align: right;">
                    <button class="btn btn-secondary" onclick="closeModal('configModal')" style="margin-right: 10px;">取消</button>
                    <button class="btn btn-primary" id="saveConfigBtn">保存配置</button>
                </div>
            </div>
        </div>
    </div>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>